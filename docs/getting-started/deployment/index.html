<!DOCTYPE html>













<html class="theme-next gemini" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">







  <meta name="yandex-verification" content="3ac9ae36ddebb425">
















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.6.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.6.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.6.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.6.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.6.0',
    sidebar: {"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: true,
    tabs: true,
    motion: {"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="NexT User Docs – Starting to Use — Deployment">
<meta name="keywords" content="Hexo, NexT">
<meta property="og:type" content="website">
<meta property="og:title" content="Deployment">
<meta property="og:url" content="https://theme-next.org/docs/getting-started/deployment/index.html">
<meta property="og:site_name" content="NexT">
<meta property="og:description" content="NexT User Docs – Starting to Use — Deployment">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-12-02T14:40:11.514Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deployment">
<meta name="twitter:description" content="NexT User Docs – Starting to Use — Deployment">






  <link rel="canonical" href="https://theme-next.org/docs/getting-started/deployment/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Deployment | NexT</title>
  











  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="en">

  
  

  <div class="container  page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">NexT</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Theme for Hexo</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-news">

    
    
    
      
    

    
      
    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-bullhorn"></i> <br>News</a>

  </li>
        
        
        
          
            
            
            
              
              

  
  
    
  
  <li class="menu-item menu-item-docs menu-item-active">

    
    
    
      
    

    
      
    

    <a href="/docs/" rel="section"><i class="menu-item-icon fa fa-fw fa-book"></i> <br>Docs</a>

  </li>


            
          
            
            
            
          
            
            
            
          
            
            
            
          
            
            
            
          
            
            
            
          
            
            
            
          
            
            
            
          
        
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    
      
    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives<span class="badge">3</span></a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    
  
  
  
  

  

    <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZW1lLW5leHQvaGV4by10aGVtZS1uZXh0" title="Fork NexT on GitHub" aria-label="Fork NexT on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill: #222; color: #fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></span>



    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

    
    
      
      
    
      
      

        
        
        

          
          <ul id="sub-menu" class="sub-menu menu">
          
            
            
              
              
                
              
            
          
            
            
              
              
              
                
                  
                  

  
  
    
  
  <li class="menu-item menu-item-getting-started menu-item-active">

    
    
    
      
    

    
      
    

    <a href="/docs/getting-started/" rel="section"><i class="menu-item-icon fa fa-fw fa-flag"></i> <br>Getting Started</a>

  </li>


                
              
                
              
                
              
                
              
                
              
            
          
            
            
              
              
                
                  
                
                

  
  
    
  
  <li class="menu-item menu-item-theme-settings">

    
    
    
      
    

    
      
    

    <a href="/docs/theme-settings/" rel="section"><i class="menu-item-icon fa fa-fw fa-star"></i> <br>Theme Settings</a>

  </li>


              
            
          
            
            
              
              
              
                
                  
                  

  
  
    
  
  <li class="menu-item menu-item-third-party-services">

    
    
    
      
    

    
      
    

    <a href="/docs/third-party-services/" rel="section"><i class="menu-item-icon fa fa-fw fa-plug"></i> <br>Third Party Services</a>

  </li>


                
              
                
              
                
              
                
              
                
              
                
              
                
              
            
          
            
            
              
              
              
                
                  
                  

  
  
    
  
  <li class="menu-item menu-item-tag-plugins">

    
    
    
      
    

    
      
    

    <a href="/docs/tag-plugins/" rel="section"><i class="menu-item-icon fa fa-fw fa-rocket"></i> <br>Tag Plugins</a>

  </li>


                
              
                
              
                
              
                
              
                
              
                
              
                
              
            
          
            
            
              
              
                
                  
                
                

  
  
    
  
  <li class="menu-item menu-item-advanced-settings">

    
    
    
      
    

    
      
    

    <a href="/docs/advanced-settings/" rel="section"><i class="menu-item-icon fa fa-fw fa-cogs"></i> <br>Advanced Settings</a>

  </li>


              
            
          
            
            
              
              
                
                  
                
                

  
  
    
  
  <li class="menu-item menu-item-faq's">

    
    
    
      
    

    
      
    

    <a href="/docs/faqs/" rel="section"><i class="menu-item-icon fa fa-fw fa-life-ring"></i> <br>FAQ's</a>

  </li>


              
            
          
            
            
              
              
                
                  
                
                

  
  
    
  
  <li class="menu-item menu-item-troubleshooting">

    
    
    
      
    

    
      
    

    <a href="/docs/troubleshooting/" rel="section"><i class="menu-item-icon fa fa-fw fa-bug"></i> <br>Troubleshooting</a>

  </li>


              
            
          
          </ul>
          

          
          
            
            
          
            
            

              
                
                
                  
                
                
              
                
                
                

                  
                  
                  
                    

                      
                      <ul id="sub-menu-2" class="sub-menu menu">
                      
                        
                        
                        
                          
                        
                      
                        
                        
                        
                          
                            
                          
                          

  
  
    
  
  <li class="menu-item menu-item-installation">

    
    
    
      
    

    
      
    

    <a href="/docs/getting-started/installation/" rel="section"><i class="menu-item-icon fa fa-fw fa-download"></i> <br>Installation</a>

  </li>


                        
                      
                        
                        
                        
                          
                            
                          
                          

  
  
    
  
  <li class="menu-item menu-item-deployment menu-item-active">

    
    
    
      
    

    
      
    

    <a href="/docs/getting-started/deployment/" rel="section"><i class="menu-item-icon fa fa-fw fa-upload"></i> <br>Deployment</a>

  </li>


                        
                      
                        
                        
                        
                          
                            
                          
                          

  
  
    
  
  <li class="menu-item menu-item-data-files">

    
    
    
      
    

    
      
    

    <a href="/docs/getting-started/data-files/" rel="section"><i class="menu-item-icon fa fa-fw fa-wrench"></i> <br>Data Files</a>

  </li>


                        
                      
                        
                        
                        
                          
                            
                          
                          

  
  
    
  
  <li class="menu-item menu-item-update-from-5.x">

    
    
    
      
    

    
      
    

    <a href="/docs/getting-started/update-from-v5/" rel="section"><i class="menu-item-icon fa fa-fw fa-retweet"></i> <br>Update from 5.x</a>

  </li>


                        
                      
                      </ul>
                      

                    
                  
                  

                
              
                
                
                
              
                
                
                

                  
                  
                  
                    
                  
                  

                
              
                
                
                

                  
                  
                  
                    
                  
                  

                
              
                
                
                
              
                
                
                
              
                
                
                
              

            
          
            
            
          
          

        
        

      
    
      
      
    
    

  


          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">

<h2 class="post-title" itemprop="name headline">Deployment</h2>

<div class="post-meta">
  
    <div class="post-description">NexT User Docs – Starting to Use — Deployment</div>
  
  


  
  
  <ul class="breadcrumb">
    
      
      
        
          
            
          
          <li><a href="/docs/">DOCS</a></li>
        
      
    
      
      
        
          
            
          
          <li><a href="/docs/getting-started/">GETTING-STARTED</a></li>
        
      
    
      
      
        
          <li>DEPLOYMENT</li>
        
      
    
      
      
    
  </ul>


</div>

</header>

      
      
      
      <div class="post-body">
        
        
          <h3 id="Local-Deployment"><a href="#Local-Deployment" class="headerlink" title="Local Deployment"></a>Local Deployment</h3><ol>
<li>Modify files locally.</li>
<li>Localization testing: <code>hexo clean &amp;&amp; hexo g &amp;&amp; hexo s</code>.</li>
<li>Deployment: <code>hexo g -d</code>.</li>
</ol>
<h3 id="Continuous-Integration"><a href="#Continuous-Integration" class="headerlink" title="Continuous Integration"></a>Continuous Integration</h3><ul>
<li>Edit the file directly online, effective immediately</li>
<li>Automatic deployment, simultaneous deployment to multiple locations</li>
</ul>
<div class="tabs" id="ci"><ul class="nav-tabs"><li class="tab active"><a href="#ci-1">Travis CI</a></li><li class="tab"><a href="#ci-2">Gitlab CI</a></li></ul><div class="tab-content"><div class="tab-pane active" id="ci-1"><p>Travis CI enables your team to test and ship your apps with confidence. It’s built for everyone and for projects and teams of all sizes, supporting over 20 different languages out of the box, including Javascript and Node.js, Ruby, PHP, Python, Mac/iOS, as well as Docker, while giving you full control over the build environment to customize it to your own needs.</p>
<div class="tabs" id="ci1"><ul class="nav-tabs"><li class="tab active"><a href="#ci1-1">Get permissions →</a></li><li class="tab"><a href="#ci1-2">Configure <code>.travis.yml</code></a></li></ul><div class="tab-content"><div class="tab-pane active" id="ci1-1"><p>There are two ways to obtain the necessary permissions for Travis CI. Deploy Key has the advantage of high security, while Access Token has the advantage of being more flexible.</p>
<div class="tabs" id="ci2"><ul class="nav-tabs"><li class="tab active"><a href="#ci2-1">Access Token</a></li><li class="tab"><a href="#ci2-2">Deploy Key</a></li></ul><div class="tab-content"><div class="tab-pane active" id="ci2-1"><p>This method applies to a warehouse with a private Submodule</p>
<ul>
<li>Create an empty branch of <code>source</code> in the repository where the blog source is hosted.</li>
<li>Get the Access Token: Settings -&gt; Developer settings -&gt; Personal access token -&gt; Generate new token. Set access rights according to the actual situation. It should be noted that the access token is only displayed once on this page, and it should be copied, otherwise it can only be regenerated.</li>
<li>Use github account to log in to <span class="exturl" data-url="aHR0cHM6Ly90cmF2aXMtY2kuY29tLw==" title="https://travis-ci.com/">Travis CI website<i class="fa fa-external-link"></i></span>. You can find the warehouses in the current github account, select the warehouses to be deployed, and then click setting. Fill in the personal access token generated by github and select the branch that the warehouse needs to be monitored by Travis.</li>
</ul></div><div class="tab-pane" id="ci2-2"><p>Deploy key is a SSH key set in your repo to grant client read-only (as well as r/w, if you want) access to your repo. This method is suitable for most public blog repositories and there are no private sub-modules in the repositories.</p>
<ul>
<li>Create an empty branch of <code>source</code> in the repository where the blog source is hosted.</li>
<li><p>Generate a ssh key</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C &quot;&#123;email&#125;&quot; -f ~/.ssh/deploy_key</span><br></pre></td></tr></table></figure>
</li>
<li><p>Add the deployment public key in your repo, and delete it</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ rm -f deploy_key.pub</span><br></pre></td></tr></table></figure>
</li>
<li><p>Use the Travis command to encrypt private key, and add it to git</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ gem install travis</span><br><span class="line">$ travis login</span><br><span class="line">$ travis encrypt deploy_key</span><br><span class="line">$ rm -f deploy_key</span><br><span class="line">$ git add deploy_key.enc</span><br></pre></td></tr></table></figure>

</li>
</ul></div></div></div></div><div class="tab-pane" id="ci1-2"><figure class="highlight yml"><figcaption><span>hexo/.travis.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">dist:</span> <span class="string">trusty</span></span><br><span class="line"><span class="attr">sudo:</span> <span class="string">required</span></span><br><span class="line"></span><br><span class="line"><span class="attr">addons:</span></span><br><span class="line"><span class="attr"> ssh_known_hosts:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">github.com</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">git.coding.net</span></span><br><span class="line"><span class="attr"> apt:</span></span><br><span class="line"><span class="attr">   packages:</span></span><br><span class="line"><span class="bullet">     -</span> <span class="string">nasm</span></span><br><span class="line"></span><br><span class="line"><span class="attr">env:</span></span><br><span class="line"><span class="attr"> global:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">TZ=Asia/Tokyo</span></span><br><span class="line"></span><br><span class="line"><span class="attr">language:</span> <span class="string">node_js</span></span><br><span class="line"><span class="attr">node_js:</span> <span class="string">node</span></span><br><span class="line"></span><br><span class="line"><span class="attr">branches:</span></span><br><span class="line"><span class="attr"> only:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">source</span></span><br><span class="line"></span><br><span class="line"><span class="attr">git:</span></span><br><span class="line"><span class="attr"> depth:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr"> submodules:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="attr">cache:</span></span><br><span class="line"><span class="attr"> apt:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr"> directories:</span></span><br><span class="line"><span class="bullet">   -</span> <span class="string">node_modules</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_install:</span></span><br><span class="line"> <span class="comment"># Git Config</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">sed</span> <span class="bullet">-i</span> <span class="string">'s/git@github.com:/https:\/\/github.com\//'</span> <span class="string">.gitmodules</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"YOUR-GITHUB-NAME"</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"YOUR-EMAIL"</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># Restore last modified time</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">"git ls-files -z | while read -d '' path; do touch -d \"$(git log -1 --format=\"@%ct\" \"$path\")\" \"$path\"; done"</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># Submodules</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">git</span> <span class="string">submodule</span> <span class="string">update</span> <span class="bullet">--recursive</span> <span class="bullet">--remote</span> <span class="bullet">--init</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># Deploy history</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">git</span> <span class="string">clone</span> <span class="bullet">--branch=master</span> <span class="bullet">--single-branch</span> <span class="string">YOUR-BLOG-REPO</span> <span class="string">.deploy_git</span></span><br><span class="line"></span><br><span class="line"> <span class="comment"># SSH Setup</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">openssl</span> <span class="string">aes-256-cbc</span> <span class="bullet">-K</span> <span class="string">$encrypted_693585a97b8c_key</span> <span class="bullet">-iv</span> <span class="string">$encrypted_693585a97b8c_iv</span> <span class="bullet">-in</span> <span class="string">deploy_key.enc</span> <span class="bullet">-out</span> <span class="string">deploy_key</span> <span class="bullet">-d</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">eval</span> <span class="string">"$(ssh-agent -s)"</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">chmod</span> <span class="number">600</span> <span class="string">./deploy_key</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">ssh-add</span> <span class="string">./deploy_key</span></span><br><span class="line"></span><br><span class="line"><span class="attr">install:</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line"></span><br><span class="line"><span class="attr">before_script:</span></span><br><span class="line"></span><br><span class="line"><span class="attr">script:</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">hexo</span> <span class="string">clean</span></span><br><span class="line"><span class="bullet"> -</span> <span class="string">hexo</span> <span class="string">g</span> <span class="bullet">-d</span></span><br></pre></td></tr></table></figure></div></div></div></div><div class="tab-pane" id="ci-2"><p>GitLab offers a continuous integration service. If you add a <code>.gitlab-ci.yml</code> file to the root directory of your repository, and configure your GitLab project to use a Runner, then each commit or push, triggers your CI pipeline. The <code>.gitlab-ci.yml</code> file tells the GitLab runner what to do. By default it runs a pipeline with three stages: build, test, and deploy. You don&#39;t need to use all three stages; stages with no jobs are simply ignored.</p>
<ol>
<li>Add <code>.gitlab-ci.yml</code> to the root directory of your repository, and configure it.</li>
<li>Upload <code>scaffolds</code>, <code>source</code>, <code>themes</code>, <code>.gitignor</code>, <code>.gitlab-ci.yml</code>, <code>_config.yml</code>, and <code>package.json</code> to <span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuY29tLw==" title="https://gitlab.com/">your Gitlab repository<i class="fa fa-external-link"></i></span>. <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ git init</span><br><span class="line">$ ssh -T git@gitlab.com</span><br><span class="line">$ git remote add origin YOUR-GITLAB-REPO-SSH-LINK</span><br><span class="line">$ git add .</span><br><span class="line">$ git commit -m &quot;COMMIT MESSAGE&quot;</span><br><span class="line">$ git push -u origin master</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>There are two ways to configure <code>.gitlab-ci.yml</code>:</p>
<div class="tabs" id="gitlab-ci-1"><ul class="nav-tabs"><li class="tab active"><a href="#gitlab-ci-1-1"><code>HTTPS</code></a></li><li class="tab"><a href="#gitlab-ci-1-2"><code>SSH</code></a></li></ul><div class="tab-content"><div class="tab-pane active" id="gitlab-ci-1-1"><ul>
<li>Get the Access Token: Settings -&gt; Developer settings -&gt; Personal access token -&gt; Generate new token. Set access rights according to the actual situation. It should be noted that the access token is only displayed once on this page, and it should be copied, otherwise it can only be regenerated.</li>
<li><p>Configure <code>.gitlab-ci.yml</code>:</p>
  <figure class="highlight yml"><figcaption><span>hexo/.gitlab-ci.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">export</span> <span class="string">TZ='Asia/Shanghai'</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"YOUR-USER-NAME"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"YOUR-EMAIL"</span></span><br><span class="line">  <span class="comment"># Restore last modified time</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"git ls-files -z | while read -d '' path; do touch -d \"$(git log -1 --format=\"@%ct\" \"$path\")\" \"$path\"; done"</span></span><br><span class="line">  <span class="comment"># Install ssh-agent if not already installed, it is required by Docker.</span></span><br><span class="line">  <span class="comment"># (change apt-get to yum if you use a CentOS-based image)</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'which ssh-agent || ( apt-get update -y &amp;&amp; apt-get install openssh-client -y )'</span></span><br><span class="line">  <span class="comment"># Run ssh-agent (inside the build environment)</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">eval</span> <span class="string">$(ssh-agent</span> <span class="bullet">-s)</span></span><br><span class="line">  <span class="comment"># Add the SSH key stored in SSH_PRIVATE_KEY variable to the agent store</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">ssh-add</span> <span class="string">&lt;(echo</span> <span class="string">"$DEPLOY_PRIVATE_KEY"</span><span class="string">)</span></span><br><span class="line">  <span class="comment"># For Docker builds disable host key checking. Be aware that by adding that</span></span><br><span class="line">  <span class="comment"># you are suspectible to man-in-the-middle attacks.</span></span><br><span class="line">  <span class="comment"># WARNING: Use this only with the Docker executor, if you use it with shell</span></span><br><span class="line">  <span class="comment"># you will overwrite your user's SSH config.</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">mkdir</span> <span class="bullet">-p</span> <span class="string">~/.ssh</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'[[ -f /.dockerenv ]] &amp;&amp; echo -e "Host *\n\tStrictHostKeyChecking no\n\n" &gt; ~/.ssh/config'</span></span><br><span class="line">  <span class="comment"># In order to properly check the server's host key, assuming you created the</span></span><br><span class="line">  <span class="comment"># SSH_SERVER_HOSTKEYS variable previously, uncomment the following two lines</span></span><br><span class="line">  <span class="comment"># instead.</span></span><br><span class="line">  <span class="comment"># - mkdir -p ~/.ssh</span></span><br><span class="line">  <span class="comment"># - '[[ -f /.dockerenv ]] &amp;&amp; echo "$SSH_SERVER_HOSTKEYS" &gt; ~/.ssh/known_hosts'</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">apt-get</span> <span class="string">update</span> <span class="bullet">-qq</span> <span class="string">&amp;&amp;</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="bullet">-y</span> <span class="bullet">-qq</span> <span class="string">pandoc</span></span><br><span class="line"></span><br><span class="line"><span class="attr">image:</span> <span class="attr">node:6.10.2</span></span><br><span class="line"></span><br><span class="line"><span class="attr">pages:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-cli</span> <span class="bullet">-g</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">  <span class="comment"># NEXT NPM installation</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-symbols-count-time</span> <span class="bullet">--save</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">clone</span> <span class="attr">https://github.com/theme-next/theme-next-pace</span> <span class="string">themes/next/source/lib/pace</span></span><br><span class="line">  <span class="comment"># NEXT NPM installation</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">./node_modules/hexo/bin/hexo</span> <span class="string">generate</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">cd</span> <span class="string">./public</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">init</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"YOUR-USER-NAME"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"YOUR-EMAIL"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">push.default</span> <span class="string">simple</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">add</span> <span class="string">.</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">commit</span> <span class="bullet">-m</span> <span class="string">"gitlab-auto-deploy"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">push</span> <span class="bullet">--force</span> <span class="bullet">--quiet</span> <span class="bullet">--set-upstream</span> <span class="attr">https://github_access_token@github.com/username/username.github.io.git</span> <span class="string">master</span> <span class="comment"># replace github_access_token</span></span><br><span class="line">  <span class="comment"># - git config http.postBuffer 524288000</span></span><br><span class="line">  <span class="comment"># - git push --force --quiet --set-upstream https://username:password@git.coding.net/username/reponame.git master # replace username &amp; password, please escape the password</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  artifacts:</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">public</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
</li>
</ul></div><div class="tab-pane" id="gitlab-ci-1-2"><p>Deploy key is a SSH key set in your repo to grant client read-only (as well as r/w, if you want) access to your repo. This method is suitable for most public blog repositories and there are no private sub-modules in the repositories.</p>
<ul>
<li><p>Generate a deploy key</p>
  <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">$ ssh-keygen -t rsa -b 4096 -C &quot;&#123;email&#125;&quot; -f ~/.ssh/deploy_key</span><br></pre></td></tr></table></figure>
</li>
<li><p>Click <code>SETTINGS-CI/CD → Variables</code> in Gitlab, copy the content of private key and defined it as custom variable <code>DEPLOY_PRIVATE_KEY</code>.</p>
</li>
<li><p>Configure <code>.gitlab-ci.yml</code>:</p>
  <figure class="highlight yml"><figcaption><span>hexo/.gitlab-ci.yml</span></figcaption><table><tr><td class="code"><pre><span class="line"><span class="attr">before_script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">export</span> <span class="string">TZ='Asia/Shanghai'</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"YOUR-USER-NAME"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"YOUR-EMAIL"</span></span><br><span class="line">  <span class="comment"># Restore last modified time</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">"git ls-files -z | while read -d '' path; do touch -d \"$(git log -1 --format=\"@%ct\" \"$path\")\" \"$path\"; done"</span></span><br><span class="line">  <span class="comment"># Install ssh-agent if not already installed, it is required by Docker.</span></span><br><span class="line">  <span class="comment"># (change apt-get to yum if you use a CentOS-based image)</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'which ssh-agent || ( apt-get update -y &amp;&amp; apt-get install openssh-client -y )'</span></span><br><span class="line">  <span class="comment"># Run ssh-agent (inside the build environment)</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">eval</span> <span class="string">$(ssh-agent</span> <span class="bullet">-s)</span></span><br><span class="line">  <span class="comment"># Add the SSH key stored in SSH_PRIVATE_KEY variable to the agent store</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">ssh-add</span> <span class="string">&lt;(echo</span> <span class="string">"$DEPLOY_PRIVATE_KEY"</span><span class="string">)</span></span><br><span class="line">  <span class="comment"># For Docker builds disable host key checking. Be aware that by adding that</span></span><br><span class="line">  <span class="comment"># you are suspectible to man-in-the-middle attacks.</span></span><br><span class="line">  <span class="comment"># WARNING: Use this only with the Docker executor, if you use it with shell</span></span><br><span class="line">  <span class="comment"># you will overwrite your user's SSH config.</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">mkdir</span> <span class="bullet">-p</span> <span class="string">~/.ssh</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">'[[ -f /.dockerenv ]] &amp;&amp; echo -e "Host *\n\tStrictHostKeyChecking no\n\n" &gt; ~/.ssh/config'</span></span><br><span class="line">  <span class="comment"># In order to properly check the server's host key, assuming you created the</span></span><br><span class="line">  <span class="comment"># SSH_SERVER_HOSTKEYS variable previously, uncomment the following two lines</span></span><br><span class="line">  <span class="comment"># instead.</span></span><br><span class="line">  <span class="comment"># - mkdir -p ~/.ssh</span></span><br><span class="line">  <span class="comment"># - '[[ -f /.dockerenv ]] &amp;&amp; echo "$SSH_SERVER_HOSTKEYS" &gt; ~/.ssh/known_hosts'</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">apt-get</span> <span class="string">update</span> <span class="bullet">-qq</span> <span class="string">&amp;&amp;</span> <span class="string">apt-get</span> <span class="string">install</span> <span class="bullet">-y</span> <span class="bullet">-qq</span> <span class="string">pandoc</span></span><br><span class="line"></span><br><span class="line"><span class="attr">image:</span> <span class="attr">node:6.10.2</span></span><br><span class="line"></span><br><span class="line"><span class="attr">pages:</span></span><br><span class="line"><span class="attr">  cache:</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">node_modules/</span></span><br><span class="line"><span class="attr">  script:</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="bullet">-g</span> <span class="string">hexo-cli</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span></span><br><span class="line">  <span class="comment"># NEXT NPM installation</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">npm</span> <span class="string">install</span> <span class="string">hexo-symbols-count-time</span> <span class="bullet">--save</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">clone</span> <span class="attr">https://github.com/theme-next/theme-next-pace</span> <span class="string">themes/next/source/lib/pace</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">generate</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.name</span> <span class="string">"YOUR-USER-NAME"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">git</span> <span class="string">config</span> <span class="bullet">--global</span> <span class="string">user.email</span> <span class="string">"YOUR-EMAIL"</span></span><br><span class="line"><span class="bullet">  -</span> <span class="string">hexo</span> <span class="string">deploy</span></span><br><span class="line"></span><br><span class="line"><span class="attr">  artifacts:</span></span><br><span class="line"><span class="attr">    paths:</span></span><br><span class="line"><span class="bullet">      -</span> <span class="string">public</span></span><br><span class="line"><span class="attr">  only:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="string">master</span></span><br></pre></td></tr></table></figure>
</li>
</ul></div></div></div></div></div></div>

        
      </div>
      
      
      
    </div>
    


  
  
  <ul class="breadcrumb">
    
      
      
        
          
            
          
          <li><a href="/docs/">DOCS</a></li>
        
      
    
      
      
        
          
            
          
          <li><a href="/docs/getting-started/">GETTING-STARTED</a></li>
        
      
    
      
      
        
          <li>DEPLOYMENT</li>
        
      
    
      
      
    
  </ul>


    
    
    
  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/apple-touch-icon-next.png" alt="Theme NexT">
            
              <p class="site-author-name" itemprop="name">Theme NexT</p>
              <p class="site-description motion-element" itemprop="description">Stay Simple. Stay NexT.</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZW1lLW5leHQ=" title="GitHub &rarr; https://github.com/theme-next"><i class="fa fa-fw fa-github"></i></span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="mailto:support@theme-next.org" title="E-Mail &rarr; mailto:support@theme-next.org"><i class="fa fa-fw fa-envelope"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9naXR0ZXIuaW0vdGhlbWUtbmV4dA==" title="Gitter &rarr; https://gitter.im/theme-next"><i class="fa fa-fw fa-github-alt"></i></span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly9yaW90LmltL2FwcC8jL3Jvb20vI05leFQ6bWF0cml4Lm9yZw==" title="Riot &rarr; https://riot.im/app/#/room/#NexT:matrix.org"><i class="fa fa-fw fa-bullhorn"></i></span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly90Lm1lL2pvaW5jaGF0L0dVTkhYQS12WmtnU011aW1MMVZtTXc=" title="Telegram [Chat] &rarr; https://t.me/joinchat/GUNHXA-vZkgSMuimL1VmMw"><i class="fa fa-fw fa-telegram"></i></span>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <span class="exturl" data-url="aHR0cHM6Ly90Lm1lL3RoZW1lX25leHQ=" title="Telegram [News] &rarr; https://t.me/theme_next"><i class="fa fa-fw fa-telegram"></i></span>
                </span>
              
            </div>
          

          
             <div class="cc-license motion-element" itemprop="license">
              
                
              
              
              
              <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC8="><img src="/images/cc-by-nc-sa.svg" alt="Creative Commons"></span>
             </div>
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Local-Deployment"><span class="nav-number">1.</span> <span class="nav-text">Local Deployment</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Continuous-Integration"><span class="nav-number">2.</span> <span class="nav-text">Continuous Integration</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2014 – <span itemprop="copyrightYear">2018</span>
  <span class="with-love" id="animate">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">NexT</span>

  

  
</div>


  <div class="powered-by">Powered by <span class="exturl theme-link" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> v3.8.0</div>







  <div class="footer-custom">Theme source code <span class="exturl theme-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZW1lLW5leHQvaGV4by10aGVtZS1uZXh0">here</span><br>Website source code <span class="exturl theme-link" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZW1lLW5leHQvdGhlbWUtbmV4dC5vcmc=">here</span></div>


        








        
      </div>
    </footer>

    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>







  




















  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.6.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.6.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.6.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.6.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.6.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.6.0"></script>



  

  
    <script id="dsq-count-scr" src="https://theme-next.disqus.com/count.js" async></script>
  

  
    <script type="text/javascript">
      var disqus_config = function () {
        this.page.url = 'https://theme-next.org/docs/getting-started/deployment/index.html';
        this.page.identifier = 'docs/getting-started/deployment/index.html';
        this.page.title = 'Deployment';
        this.language = 'en';
        };
      function loadComments () {
        var d = document, s = d.createElement('script');
        s.src = 'https://theme-next.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      }
      
        $(function () {
          var offsetTop = $('#comments').offset().top - $(window).height();
          if (offsetTop <= 0) {
            // load directly when there's no a scrollbar
            loadComments();
          } else {
            $(window).on('scroll.disqus_scroll', function () {
              // offsetTop may changes because of manually resizing browser window or lazy loading images.
              var offsetTop = $('#comments').offset().top - $(window).height();
              var scrollTop = $(window).scrollTop();

              // pre-load comments a bit? (margin or anything else)
              if (offsetTop - scrollTop < 60) {
                $(window).off('.disqus_scroll');
                loadComments();
              }
            });
          }
        });
      
    </script>
  












  





  

  

  

  

  
  

  
  

  


  
  

  

  

  
  <script type="text/javascript" src="/js/src/exturl.js?v=6.6.0"></script>


  

  

  

</body>
</html>
